<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Telegram Form</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>

    <h2 id="form-title">User Information</h2>
    <form id="userForm">
        <input type="hidden" id="bot_token" value="7100869336:AAGcqGRUKa1Q__gLmDVWJCM4aZQcD-1K_eg"> 
        <input type="hidden" id="admin_id" value="8101143576"> 
        <input type="hidden" id="user_id">
        <input type="hidden" id="username">
        <input type="hidden" id="form_type"> 

        <div id="form-content"> 
            <!-- Dynamic content will be inserted here -->
        </div>

        <button type="button" onclick="submitForm()">Submit</button>
    </form>

   <script>
    let tg = window.Telegram.WebApp;
    tg.expand();

    document.getElementById("user_id").value = tg.initDataUnsafe?.user?.id || "N/A";
    document.getElementById("username").value = "@" + (tg.initDataUnsafe?.user?.username || "N/A");

    function getQueryParam(name) {
        let params = new URLSearchParams(window.location.search);
        return params.get(name);
    }

    let formType = getQueryParam("type");
    document.getElementById("form_type").value = formType;

    let formContent = document.getElementById("form-content");

    let formFields = {
        "canteen": { title: "ü•ó Canteen Order Form", fields: ["Meal Type", "Quantity"] },
        "airport": { title: "‚úà Airport Pickup Form", fields: ["Arrival Date", "Flight Number"] },
        "hotel": { title: "üè® Hotel Booking Form", fields: ["Check-in Date", "Hotel Name"] },
        "visa": { title: "üîñ Visa Application Form", fields: ["Full Name", "Passport Number"] },
        "rental": { title: "üè§ House Rental Form", fields: ["Location", "Budget"] },
        "logistics": { title: "üîî Logistics Form", fields: ["Package Type", "Delivery Date"] },
        "shop": { title: "üõí Shopping Form", fields: ["Product Name", "Quantity"] }
    };

    if (formType in formFields) {
        document.getElementById("form-title").innerText = formFields[formType].title;
        formContent.innerHTML = formFields[formType].fields.map(field =>
            `<label>${field}:</label><input type="text" id="${field.toLowerCase().replace(' ', '_')}" required><br><br>`
        ).join('');
    } else {
        formContent.innerHTML = `<p>‚ö†Ô∏è Unknown form type.</p>`;
    }

    function submitForm() {
        let botToken = document.getElementById("bot_token").value;
        let adminId = document.getElementById("admin_id").value;

        let formData = {
            user_id: document.getElementById("user_id").value,
            username: document.getElementById("username").value,
            form_type: formType
        };

        document.querySelectorAll("#form-content input").forEach(input => {
            formData[input.id] = input.value;
        });

        let message = `üìã *New Form Submission*\n\n`
                    + `üÜî *User ID:* ${formData.user_id}\n`
                    + `üë§ *Username:* ${formData.username}\n`
                    + `üìÑ *Form Type:* ${formData.form_type}\n`;

        for (let key in formData) {
            if (!["user_id", "username", "form_type"].includes(key)) {
                message += `üîπ *${key.replace('_', ' ').toUpperCase()}:* ${formData[key]}\n`;
            }
        }
        // ‚úÖ Replace with your Telegram bot token and admin ID
        const botToken = "7100869336:AAGcqGRUKa1Q__gLmDVWJCM4aZQcD-1K_eg";  // Replace with your bot token
        const adminId = "8101143576";    // Replace with your Telegram ID
        let apiURL = `https://api.telegram.org/bot${botToken}/sendMessage`;

        fetch(apiURL, {
            method: "POST",
            headers: { "Content-Type": "application/json" },
            body: JSON.stringify({
                chat_id: adminId,
                text: message,
                parse_mode: "Markdown"
            })
        }).then(response => response.json())
        .then(data => {
            alert("‚úÖ Form Submitted!");
            tg.close();
        })
        .catch(error => alert("‚ùå Error: " + error));
    }
</script>

</body>
</html>
